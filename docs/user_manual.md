# P波初至震相拾取系统用户手册

## 1. 系统简介

P波初至震相拾取系统是一个用于地震波形数据P波初至震相拾取的图形界面工具。系统支持MiniSEED格式波形数据的读取、显示、交互式拾取和自动拾取，并提供批处理功能。

## 2. 系统要求

- 操作系统：Windows 7/8/10/11、macOS 10.12+、Linux
- Python 3.7+
- 依赖包：
  - obspy
  - matplotlib
  - numpy
  - pandas
  - scipy

## 3. 安装说明

1. 克隆代码仓库：
```bash
git clone https://github.com/your-username/p-wave-picker.git
cd p-wave-picker
```

2. 创建虚拟环境：
```bash
python -m venv venv
source venv/bin/activate  # Linux/macOS
venv\Scripts\activate     # Windows
```

3. 安装依赖：
```bash
pip install -r requirements.txt
```

4. 运行程序：
```bash
python main.py
```

## 4. 基本操作

### 4.1 文件操作

- 打开文件：点击"文件"菜单 -> "打开"，或使用快捷键 Ctrl+O
- 保存拾取：点击"文件"菜单 -> "保存"，或使用快捷键 Ctrl+S
- 导出结果：点击"文件"菜单 -> "导出"，选择导出格式和保存位置

### 4.2 波形显示

- 缩放：使用鼠标滚轮或工具栏的缩放按钮
- 平移：按住鼠标左键拖动
- 重置视图：点击工具栏的"重置"按钮
- 显示网格：点击工具栏的"网格"按钮

### 4.3 拾取操作

- 手动拾取：在波形上点击鼠标左键
- 自动拾取：点击工具栏的"自动拾取"按钮
- 删除拾取：选中拾取点，按Delete键
- 修改质量：选中拾取点，使用工具栏的质量按钮

### 4.4 批处理

1. 点击"批处理"菜单 -> "开始批处理"
2. 选择输入目录和输出目录
3. 设置处理参数
4. 点击"开始"按钮
5. 可以随时暂停、继续或停止处理

## 5. 快捷键

- Ctrl+O：打开文件
- Ctrl+S：保存拾取
- Ctrl+E：导出结果
- Ctrl+Z：撤销
- Ctrl+Y：重做
- Delete：删除选中的拾取点
- Space：播放/暂停
- +/-：缩放
- 方向键：平移

## 6. 设置说明

### 6.1 界面设置

- 窗口大小：设置主窗口的默认大小
- 主题：选择界面主题
- 字体大小：设置界面字体大小
- 显示网格：是否显示波形网格

### 6.2 绘图设置

- 线宽：设置波形线条宽度
- 网格透明度：设置网格线透明度
- 拾取线宽：设置拾取标记线宽
- 背景颜色：设置波形背景颜色

### 6.3 处理设置

- 自动拾取阈值：设置STA/LTA算法的触发阈值
- 最小信噪比：设置最小可接受的信噪比
- 最大偏移：设置最大可接受的拾取偏移

### 6.4 路径设置

- 备份目录：设置自动备份文件的保存位置
- 导出目录：设置导出文件的默认保存位置

### 6.5 滤波器设置

- 启用滤波：是否启用波形滤波
- 滤波器类型：选择滤波器类型（带通、低通、高通）
- 频率范围：设置滤波器的频率范围

## 7. 常见问题

### 7.1 文件格式问题

Q: 支持哪些文件格式？
A: 目前主要支持MiniSEED格式，未来将支持更多格式。

Q: 文件无法打开怎么办？
A: 检查文件格式是否正确，文件是否完整，以及是否有读取权限。

### 7.2 拾取问题

Q: 如何提高拾取精度？
A: 可以调整波形显示比例，使用缩放功能，并确保信号质量良好。

Q: 自动拾取不准确怎么办？
A: 可以调整自动拾取参数，如STA/LTA阈值，或使用手动拾取。

### 7.3 批处理问题

Q: 批处理中断后如何继续？
A: 系统会自动保存进度，重新启动后可以继续处理。

Q: 如何处理大量文件？
A: 建议分批处理，每批文件数量不要太多，并定期保存结果。

## 8. 联系与支持

- 问题反馈：提交Issue
- 功能建议：提交Pull Request
- 邮件支持：support@example.com

## 9. 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 支持基本波形显示和拾取功能
- 支持自动拾取和批处理

### v1.1.0 (2024-02-01)
- 添加更多文件格式支持
- 优化自动拾取算法
- 改进批处理功能
- 添加更多导出格式 